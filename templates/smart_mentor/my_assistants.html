{% extends 'base_site.html' %}
{% load i18n %}
{% load static %}

{% block navbar %}
    {% include 'nav_home.html' %}
{% endblock %}

{% block content %}

    <style>
        .assistant-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            padding: 20px;
        }
	.assistant-card {
    position: relative; /* Ajoutez cette ligne */
    border: 1px solid #ddd;
    border-radius: 10px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    width: 300px;
    text-align: center;
    padding: 20px;
    background-color: white;
    display: flex;
    align-items: center;
    gap: 15px;
}

        .assistant-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            object-fit: cover;
        }

        .assistant-info {
            flex-grow: 1;
        }

        .assistant-card h3 {
            color: #333;
            margin-bottom: 10px;
        }

        .assistant-card p {
            color: #666;
            font-size: 0.9em;
        }

	.delete-icon {
	    cursor: pointer;
	    position: absolute;
	    top: 10px;
	    right: 10px;
	    font-size: 20px;
	    color: #FF0000;
	}

    </style>

    <div class="assistant-container">
        {% for assistant in assistants %}
            <div class="assistant-card">
                <img src="{{ assistant.avatar_url|default:'/static/images/assistant_avatar.png' }}" alt="Avatar" class="assistant-avatar">
		<span class="delete-icon" data-id="{{ assistant.id }}">&times;</span>
                <div class="assistant-info">
                    <h3>{{ assistant.name }}</h3>
                    <p>{{ assistant.description }}</p>
                    <!-- Vous pouvez ajouter d'autres dÃ©tails ici -->
                </div>
            </div>
        {% empty %}
            <p>{% trans 'No Assistant has been created yet!' %}</p>
        {% endfor %}
    </div>

{% endblock %}

{% block extra_scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        var deleteIcons = document.querySelectorAll('.delete-icon');

        deleteIcons.forEach(function(icon) {
            icon.addEventListener('click', function() {
                var assistantId = this.getAttribute('data-id');
                var confirmation = confirm("Are you sure you want to delete this assistant?");

                if (confirmation) {
                    // Construisez l'URL de suppression ici en utilisant l'ID de l'assistant
                    var deleteUrl = "{% url 'delete_assistant' 999999 %}".replace('999999', assistantId);
                    
                    var form = document.createElement('form');
                    form.method = 'POST';
                    form.action = deleteUrl;
                    form.style.display = 'none';

                    // Ajoutez le CSRF token au formulaire
                    var csrfTokenInput = document.createElement('input');
                    csrfTokenInput.setAttribute('type', 'hidden');
                    csrfTokenInput.setAttribute('name', 'csrfmiddlewaretoken');
                    csrfTokenInput.setAttribute('value', '{{ csrf_token }}');
                    form.appendChild(csrfTokenInput);

                    document.body.appendChild(form);
                    form.submit();
                }
            });
        });
    });
</script>
{% endblock %}

